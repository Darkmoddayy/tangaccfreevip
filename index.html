<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>DARKMODDAYY MAX LEVEL</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
body{
  background:#000;
  color:#00ffff;
  font-family:Arial;
  text-align:center;
}
.box{
  margin:40px auto;
  padding:20px;
  width:90%;
  max-width:500px;
  border:2px solid #00ffff;
  box-shadow:0 0 25px #00ffff;
}
button{
  padding:15px 30px;
  background:#00ffff;
  border:none;
  font-weight:bold;
  cursor:pointer;
  box-shadow:0 0 20px #00ffff;
}
input,textarea{
  width:90%;
  padding:10px;
  margin:5px;
}
</style>
</head>

<body>

<!-- USER PANEL -->
<div id="userBox" class="box">
<h1>ğŸ NHáº¬N ACC VIP</h1>
<h2 id="totalAcc">Äang táº£i...</h2>
<button onclick="nhanAcc()">NHáº¬N ACC</button>
<h2 id="status"></h2>
  <div class="tyle">
  <p>ğŸ“Š Tá»‰ lá»‡ nháº­n acc:</p>
  <p>âŒ 70% acc lá»—i (vÃ o khÃ´ng Ä‘Æ°á»£c)</p>
  <p>ğŸ”¥ 29.9% acc LV1500 â†’ LVMAX</p>
  <p>ğŸ‰ 0.1% acc DRAGON VÄ¨NH VIá»„N</p>
  </div>
</div>

<!-- ADMIN PANEL -->
<div id="adminBox" style="display:none">

<div class="box">
<h2>ğŸ” ADMIN LOGIN</h2>
<input type="password" id="pass">
<button onclick="login()">ÄÄƒng nháº­p</button>
<h3 id="msg"></h3>
</div>

<div id="panel" style="display:none">

<div class="box">
<h2>ğŸ“¦ ThÃªm acc</h2>
<input id="accInput">
<button onclick="addAcc()">ThÃªm</button>

<textarea id="bulk" placeholder="Import má»—i dÃ²ng 1 acc"></textarea>
<button onclick="importAcc()">IMPORT</button>
</div>

<div class="box">
<h2>ğŸ“‹ Danh sÃ¡ch acc</h2>
<ul id="list"></ul>
<h3>Tá»•ng: <span id="total"></span></h3>
</div>

<div class="box">
ğŸ‘¥ Online: <span id="online"></span>
</div>

</div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getDatabase, ref, get, set, remove, push, onValue, onDisconnect }
from "https://www.gstatic.com/firebasejs/12.9.0/firebase-database.js";

const app = initializeApp({
  apiKey:"AIzaSyCNeMxQYCA3C58k1RtC4XyKayQnk-xYxkg",
  databaseURL:"https://tangaccfreevip-2f58c-default-rtdb.asia-southeast1.firebasedatabase.app"
});
const db = getDatabase(app);

/* ======================
   ADMIN SECRET URL
====================== */
const params = new URLSearchParams(window.location.search);
if(params.get("darkmod")==="vipadmin"){
  document.getElementById("adminBox").style.display="block";
  document.getElementById("userBox").style.display="none";
}

/* ======================
   DEVICE ID
====================== */
const device = localStorage.getItem("device") || crypto.randomUUID();
localStorage.setItem("device",device);

/* ======================
   ONLINE TRACK
====================== */
const onlineRef = ref(db,"online/"+device);
set(onlineRef,true);
onDisconnect(onlineRef).remove();

/* ======================
   TOTAL ACC REALTIME
====================== */
onValue(ref(db,"accounts"),snap=>{
  document.getElementById("totalAcc").innerHTML =
  "ğŸ“¦ Acc cÃ²n: " + (snap.size || 0);
});

/* ======================
   NHáº¬N ACC (FIX LINK4M)
====================== */
window.nhanAcc = async function(){

  const status = document.getElementById("status");
  status.innerHTML="â³ Äang chuyá»ƒn hÆ°á»›ng Link4m...";

  const baseUrl = window.location.origin + window.location.pathname;

  if(!window.location.search.includes("done=1")){
    const link4m =
    "https://link4m.co/st?api=69100b1afc003f0eba59c189&url=https://darkmoddayy.github.io/tangaccfreevip/?done=1" +
    encodeURIComponent(baseUrl + "?done=1");

    localStorage.setItem("waiting","1");
    window.location.href = link4m;
    return;
  }

  if(localStorage.getItem("waiting")!=="1") return;
  localStorage.removeItem("waiting");

  /* ===== CHECK 2 ACC / DAY ===== */
  const today = new Date().toISOString().slice(0,10);
  const userRef = ref(db,"users/"+device);
  const snap = await get(userRef);
  let data = snap.val() || {count:0,date:today};

  if(data.date!==today){
    data.count=0;
    data.date=today;
  }

  if(data.count>=2){
    status.innerHTML="âŒ HÃ´m nay Ä‘Ã£ nháº­n 2 acc";
    return;
  }

  /* ===== RANDOM ACC ===== */
  const accSnap = await get(ref(db,"accounts"));

  if(!accSnap.exists()){
    status.innerHTML="ğŸ”¥ Háº¾T ACC ğŸ”¥";
    return;
  }

  const list = accSnap.val();
  const keys = Object.keys(list);
  const rand = keys[Math.floor(Math.random()*keys.length)];
  const acc = list[rand];

  await remove(ref(db,"accounts/"+rand));

  data.count++;
  await set(userRef,data);

  status.innerHTML="âœ… "+acc;

  /* ===== TELEGRAM NOTIFY ===== */
  fetch(`https://api.telegram.org/botYOUR_TOKEN/sendMessage?chat_id=YOUR_CHAT_ID&parse_mode=html&text=
<b>ğŸ DARKMODDAYY</b>%0A
ğŸ‘¤ Device: <code>${device}</code>%0A
ğŸ”‘ Acc: <code>${acc}</code>%0A
â° ${new Date().toLocaleString()}
`);

};

/* ======================
   ADMIN LOGIN
====================== */
let fail=0;
window.login=function(){
  if(document.getElementById("pass").value==="123456"){
    document.getElementById("panel").style.display="block";
    loadAdmin();
  }else{
    fail++;
    document.getElementById("msg").innerHTML="âŒ Sai máº­t kháº©u";
    if(fail>=5){
      document.getElementById("msg").innerHTML="ğŸ”’ KhÃ³a 5 phÃºt";
      setTimeout(()=>fail=0,300000);
    }
  }
};

/* ======================
   ADMIN LOAD
====================== */
function loadAdmin(){

  onValue(ref(db,"accounts"),snap=>{
    let html="";
    let total=0;
    snap.forEach(i=>{
      total++;
      html+=`<li>${i.val()} 
      <button onclick="delAcc('${i.key}')">X</button></li>`;
    });
    document.getElementById("list").innerHTML=html;
    document.getElementById("total").innerHTML=total;
  });

  onValue(ref(db,"online"),snap=>{
    document.getElementById("online").innerHTML=snap.size||0;
  });
}

window.addAcc=function(){
  const val=document.getElementById("accInput").value;
  if(val.trim()!==""){
    push(ref(db,"accounts"),val);
    document.getElementById("accInput").value="";
  }
};

window.importAcc=function(){
  document.getElementById("bulk").value.split("\n").forEach(a=>{
    if(a.trim()!=="") push(ref(db,"accounts"),a);
  });
  document.getElementById("bulk").value="";
};

window.delAcc=function(id){
  remove(ref(db,"accounts/"+id));
};

</script>
</body>
</html>
