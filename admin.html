<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>ADMIN PRO MAX</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
  background:#0f0f0f;
  color:#0ff;
  font-family:Arial;
  text-align:center;
}
.box{
  border:1px solid #0ff;
  margin:15px;
  padding:15px;
  box-shadow:0 0 15px #0ff;
}
input,button,textarea{
  padding:10px;
  margin:5px;
  width:90%;
}
button{
  background:#0ff;
  border:none;
  cursor:pointer;
}
</style>
</head>

<body>

<div id="loginBox" class="box">
<h2>ğŸ” ADMIN LOGIN</h2>
<input type="password" id="pass" placeholder="Nháº­p máº­t kháº©u">
<button onclick="login()">ÄÄƒng nháº­p</button>
<p id="msg"></p>
</div>

<div id="panel" style="display:none">

<h2>âš¡ ADMIN DASHBOARD</h2>

<div class="box">
ğŸ“Š Tá»•ng acc: <b id="totalAcc">0</b><br>
ğŸ‘¥ Online: <b id="online">0</b>
</div>

<div class="box">
<h3>ğŸ“¦ Import acc</h3>
<textarea id="importAcc" placeholder="user|pass"></textarea>
<button onclick="importAcc()">IMPORT</button>
</div>

<div class="box">
<h3>ğŸ“‹ Danh sÃ¡ch acc</h3>
<div id="listAcc"></div>
</div>

<div class="box">
<h3>ğŸ“ˆ User theo ngÃ y</h3>
<canvas id="chart"></canvas>
</div>

<div class="box">
<h3>ğŸ† Top user</h3>
<div id="topUser"></div>
</div>

</div>

<!-- FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import {
getDatabase, ref, set, push, onValue, remove
} from "https://www.gstatic.com/firebasejs/12.9.0/firebase-database.js";

const firebaseConfig = {
apiKey: "AIzaSyCNeMxQYCA3C58k1RtC4XyKayQnk-xYxkg",
authDomain: "tangaccfreevip-2f58c.firebaseapp.com",
databaseURL: "https://tangaccfreevip-2f58c-default-rtdb.asia-southeast1.firebasedatabase.app",
projectId: "tangaccfreevip-2f58c",
storageBucket: "tangaccfreevip-2f58c.firebasestorage.app",
messagingSenderId: "970018428565",
appId: "1:970018428565:web:3d8b15dc15b29977386d9c"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

window.login = function(){
let lock = localStorage.getItem("lock");
let fail = Number(localStorage.getItem("fail") || 0);

if(lock && Date.now()<lock){
msg.innerHTML="âŒ Bá»‹ khoÃ¡";
return;
}

if(pass.value==="123456"){
loginBox.style.display="none";
panel.style.display="block";
}
else{
fail++;
localStorage.setItem("fail",fail);
msg.innerHTML="âŒ Sai máº­t kháº©u";

if(fail>=5){
localStorage.setItem("lock",Date.now()+600000);
msg.innerHTML="ğŸ”’ KhoÃ¡ 10 phÃºt";
}
}
}

function importAcc(){
let data = importAcc.value.split("\n");
data.forEach(acc=>{
push(ref(db,"accounts"),{acc});
});
}

onValue(ref(db,"accounts"),snap=>{
let html="";
let total=0;

snap.forEach(i=>{
total++;
html+=`
<div>
${i.val().acc}
<button onclick="delAcc('${i.key}')">X</button>
</div>`;
});

listAcc.innerHTML=html;
totalAcc.innerHTML=total;
});

window.delAcc = function(id){
remove(ref(db,"accounts/"+id));
}

//// USER ONLINE
onValue(ref(db,"online"),snap=>{
online.innerHTML = snap.size;
});

//// THá»NG KÃŠ USER
onValue(ref(db,"stats"),snap=>{
let labels=[];
let data=[];

snap.forEach(i=>{
labels.push(i.key);
data.push(i.val());
});

new Chart(document.getElementById("chart"),{
type:"line",
data:{labels,datasets:[{label:"User",data}]}
});
});

//// TOP USER
onValue(ref(db,"top"),snap=>{
let html="";
snap.forEach(i=>{
html+=`<div>${i.key} : ${i.val()}</div>`;
});
topUser.innerHTML=html;
});

</script>

</body>
</html>
